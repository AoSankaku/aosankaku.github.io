{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/mcpynotify/","result":{"data":{"markdownRemark":{"html":"<p>嘘つきました。正確には作っていません。超大幅な改良を加えました。</p>\n<h1>簡単に使えるサーバー通知BOTがほしい！</h1>\n<h2>サーバー参加者のモチベの問題</h2>\n<p>最近、訳あってマイクラサーバーを開いたり閉じたりしています。</p>\n<p>参加者視点では、「今サーバーに人がいるのかどうか」というのは結構重要だったりします。やっぱり人がいるときのほうが「行きてえなあ…行きましょうよ」ってなりやすいですからね。しょうがないですね。</p>\n<p>しかし当然のことながら、マイクラサーバー自体にはそういう通知をしてくれる機能などありません。プラグインならあります。</p>\n<p><a href=\"https://www.spigotmc.org/resources/discordsrv.18494/\">https://www.spigotmc.org/resources/discordsrv.18494/</a></p>\n<h2>要件</h2>\n<p>技術の選定に当たり、以下を重視しました。</p>\n<ul>\n<li>batまたはshでないこと\n<ul>\n<li>単純にUbuntuとWindowsで交互に互換性がありません。基本的にはUbuntuで動かすとは思いますが、デバッグの容易さや個人が自宅でポート開放して小さいサーバーを開く状況を考えると、OSに依存せず動かせるものが理想です。</li>\n</ul>\n</li>\n<li>バニラ、Forge、Fabric、プラグインサーバーのいずれでもうごく普遍的（ユニバーサル）で独立（スタンドアロン）なスクリプトであること\n<ul>\n<li>BOTではこれは不可能です。また、BOT作成の手間も結構あります。正直言って小規模サーバーを作るためだけにBOTを作成するのは結構だるいです。</li>\n</ul>\n</li>\n<li>Webhookを使用すること\n<ul>\n<li>これができるとDiscordでの通知が簡単になります。</li>\n</ul>\n</li>\n</ul>\n<h2>方法</h2>\n<p>しかし、いくつかの方法で取得することはできそうです。</p>\n<ol>\n<li>マイクラサーバーの標準出力を受け取り、それを元に処理を行う</li>\n</ol>\n<ul>\n<li>ブログを書いている今思いついたアイデアなのですが、<a href=\"https://qiita.com/yutake27/items/033155608d64eac0adc2\">ありました</a>。</li>\n<li>こっちで作ってみてもいいかもしれない…というかこっちのほうが断然簡単じゃない？あーしくった……😫</li>\n</ul>\n<ol start=\"2\">\n<li>マイクラ標準のログを利用する</li>\n</ol>\n<ul>\n<li>マイクラは「latest.log」というファイルを都度出力します。これを監視して通知に加工してやろう、という算段です。</li>\n</ul>\n<p>今回は2番を採用しました。まじでなんで1じゃなくてこっちを改造したんだろう。馬鹿じゃん。</p>\n<h2>あった</h2>\n<p>ひとまず「Discord minecraft サーバー 通知」とか、そんな感じで適当なキーワードで検索したら出てきました。コレです。</p>\n<p><a href=\"https://qiita.com/somakai_sumasi/items/6dc76c5eaabe53c8118e\">https://qiita.com/somakai_sumasi/items/6dc76c5eaabe53c8118e</a></p>\n<p><a href=\"https://github.com/somakai-sumasi/Send-Minecraft-notifications\">https://github.com/somakai-sumasi/Send-Minecraft-notifications</a></p>\n<p>しかし、大量のバグや問題点がありました。</p>\n<ul>\n<li>latest.logは1行ずつ更新するとは限らないため、複数行更新すると一気に意味がわからなくなる</li>\n<li>サーバーの起動、閉鎖に関するログが流れなかった</li>\n<li><code>README.md</code>が充実していないために、使い方がPythonを知らないとよくわからない</li>\n</ul>\n<p>ということで、これを超大規模改修して、実用に足る水準まで上げました。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 126.38036809815951%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEqUlEQVQ4y3WVyYtcZRTF6z8QccgIxnSS7nR3ddfwqt48z/VevRq6qofqTpMQyWAUXEjEje7EATEixE0QQXQrLuNCFy4EXaqIW1e69R/4yffFLrpoXFze48F3vnPuuee+2uFOQp4FOEFOkpU4XkKS5Ux37hFldzFtD9tNaHcMNptdGi11Xs22tvAuqubFDpFrMwxjkqwiS0uqwZQ0r2T1B1OG413ipMS0A1qKPq8jkCNgCbi20aGrGOTFGLeaUM5uMJ3dIMn6JPmA8WSPoj/G8WKyYii/226EajjUN9tz1kegtWZDpela3Et0Pr68yoPlq2y7EW5S4oqDuoPtxvhhJhm6foJmuBiWTxDl8tsCw8ZGFyVzeDjq8s/Tz/HT0hJ74x3y/hZR3JMH+9WUajgl7Q0kSwEi2lOUY3nZQg/rTRXPtPhc7/Dn86d4vLJKsX1AllUE0RNWoodZb4Bph5KxMEhcpJseStdclFxf79CwTa5nJh9cWeVuQ8FNCvwgx3JSecALUlmij6J/HdXC9RL8IJPyFxgeTGMGpc9u6POGbvOKojHIemzPXiVMbmG7AbaXohkemuFIVgJQuCwMEbXQQz+yEXXb6fLO1TrvLa8y9WOSahvXL6QJfijYRgRxThgX8l1IFqCNtrowPrXZOKLo+cxCn9cMh9Lyiaohk+kdwvQ2hu1iuYmUK+RLkJY6Z3ZiDt3QoRi4fFU0+PvZ0/xy4QI3tw8YbR+Q94ZkvSG9/hbTnWuMxrtESYklBrytLSRnbsrKikLTt3i3UPj51Dl+PXOGt5odovGUJE7l/Ik49gcTeuWYtDckjHvSDJGeIOqh6e6ccS10LUzbwnR9AjvA12xi2yXtzbDcGR3VoKM60ogjeS3lyVOMj6ijNkjA63spxV7G+5nFj5dX+KzZZjg7ZHf3FknvEMsJKP/LtmATp3000yNKClmC6XGna8trbZqGxduawuOz5/l0eUUmIExyXC+Qch0vwgsy2b+y2pKRs72YrmYvGCMZTvo+UeiR2hH7bkhgeoRJxmjrNl70EqpuoVvBguTjUo87LAEHQ5+4F/GR0uGP8+d5tL5JuX3AeLRHEA2Ik4IwKeUsemEmZebFiDTr4/qxHPTmMcdraxtdWi2Vb5Yu8fvZc7y52UALc3Qvou0EtHSRDlceNGyRmkgCixaEUS4vEMMvBr2rWdTWmypqU+XbCxf57fRp7m+2aPgpd9brfHHxRT5cWSVwQxTVotM1pVSla8ghV1RzLl+0pN01qAWOhWWYTDSHlw2bUHfougGH0RbX1SH9ZhtVc2i0Neqbyjy/x38FR8mRkvf3UqY7AQ+TJl8vLfNgs8Xe7gGTa/fwq5s4aUmcDRiMduTouH6Kbrgn3J2bsrahoAcej/oxP19a5oelS9zvmuTjHar+gKIcyZQII8ReFCmxnFDKPO7uHHBzo40R57x+4xb3DYd93aHqb8n/iViqRX+LfjWRmRYMj5bE//716hsqfmzwZbLKX089w/dXrjCZXZcrX7AR+RVyy2oiHRUb/DjgCYbrGyphbPJJpfDd2Rd4uFannO7LtIioif0XpU+WQJoPJLAYE8G01dFPAP8LjE50QC6zcpEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot\"\n        title=\"screenshot\"\n        src=\"/static/330e3b5b7edd38d5e95c1714f5806617/a6d36/image.png\"\n        srcset=\"/static/330e3b5b7edd38d5e95c1714f5806617/222b7/image.png 163w,\n/static/330e3b5b7edd38d5e95c1714f5806617/ff46a/image.png 325w,\n/static/330e3b5b7edd38d5e95c1714f5806617/a6d36/image.png 650w,\n/static/330e3b5b7edd38d5e95c1714f5806617/295bd/image.png 667w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>実用するとこんな感じです。中々でしょう？</p>\n<h2>内容</h2>\n<p><a href=\"https://github.com/AoSankaku/Send-Minecraft-notifications#send-minecraft-notifications%E6%97%A5%E6%9C%AC%E8%AA%9E%E8%AA%AC%E6%98%8E\">https://github.com/AoSankaku/Send-Minecraft-notifications#send-minecraft-notifications%E6%97%A5%E6%9C%AC%E8%AA%9E%E8%AA%AC%E6%98%8E</a></p>\n<p>ここにすべてを置いてきました。使い方から変更点まですべて書いてあります。つまりこの記事はただの宣伝用です。ハハハハ。</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n</style>","frontmatter":{"title":"【Minecraft】マイクラサーバーでDiscordに通知を送るスクリプトを作りました","desc":"PythonとWebhookを利用した","thumbnail":null,"date":"2023-09-21","category":"Minecraft"}}},"pageContext":{"slug":"/blog/mcpynotify/"}},"staticQueryHashes":["1044384444","1252248799","164652340","1840460387","3011273866","3435873967","3683278892","970608822"],"slicesMap":{}}